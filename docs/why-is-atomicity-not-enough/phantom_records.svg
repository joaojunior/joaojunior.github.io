<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1028" height="764"><desc>title%20Phantom%20records%20with%20Repeatable%20Read%20isolation%20level%0ATransaction%20A-%3EDatabase%3AStart%20a%20transaction%2C%20Repeatable%20Read%20isolation%20level%0ATransaction%20A%3C--Database%3AOk%0ATransaction%20A-%3EDatabase%3Aselect%20amount%20from%20accounts%20where%20user_id%3D1%20and%20type%3DC%0ATransaction%20A%3C--Database%3Areturn%201%20record%0A%0ATransaction%20B-%3EDatabase%3AStart%20a%20transaction%0ATransaction%20B%3C--Database%3AOk%0ATransaction%20B-%3EDatabase%3Ainsert%20into%20accounts%20(type%2C%20amount%2C%20user_id)%20values%20(C%2C%201000%2C%201)%0ATransaction%20B%3C--Database%3AOk%0ATransaction%20B-%3EDatabase%3ACommit%20and%20end%20transaction%0ATransaction%20B%3C--Database%3Aok%0ATransaction%20A-%3EDatabase%3Aselect%20amount%20from%20accounts%20where%20user_id%3D1%20and%20type%3DC%0ATransaction%20A%3C--Database%3Areturn%202%20records%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1028" height="764"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.9958647785768" y="26.3876361" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Phantom records with Repeatable Read isolation level</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 72.83638854296484 103.26361593799999 L 72.83638854296484 764.713694178" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 499.4898680744752 103.26361593799999 L 499.4898680744752 764.713694178" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 955.4561222641887 103.26361593799999 L 955.4561222641887 764.713694178" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.795878700000003 55.765870957999994 L 136.87689838592968 55.765870957999994 L 136.87689838592968 103.26361593799999 L 8.795878700000003 103.26361593799999 L 8.795878700000003 55.765870957999994 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="27.882935478999997" y="85.67185853800001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Transaction A</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 449.02486634918614 55.765870957999994 L 549.9548697997643 55.765870957999994 L 549.9548697997643 103.26361593799999 L 449.02486634918614 103.26361593799999 L 449.02486634918614 55.765870957999994 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="468.11192312818616" y="85.67185853800001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Database</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 891.4156124212238 55.765870957999994 L 1019.4966321071536 55.765870957999994 L 1019.4966321071536 103.26361593799999 L 891.4156124212238 103.26361593799999 L 891.4156124212238 55.765870957999994 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="910.5026692002239" y="85.67185853800001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Transaction B</text></g></g><g><g><g><rect fill="white" stroke="none" x="116.87090705711849" y="138.44713073799997" width="338.58444250320315" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="119.50967066711848" y="154.279712398" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Start a transaction, Repeatable Read isolation level</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 72.83638854296484 161.31641535799997 L 485.0059878151419 161.31641535799997" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(499.4898680744752,161.31641535799997) translate(-499.4898680744752,-161.31641535799997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 484.83007024114187 153.9865164413333 L 499.4898680744752 161.31641535799997 L 484.83007024114187 168.64631427466665 Z"/></g></g><g><g><rect fill="white" stroke="none" x="274.15786384422785" y="187.70405145799995" width="24.010528928984375" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="276.79662745422786" y="203.53663311799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Ok</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 499.4898680744752 210.57333607799995 L 87.32026880229817 210.57333607799995" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"/><g transform="translate(72.83638854296484,210.57333607799995) translate(-72.83638854296484,-210.57333607799995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.49618637629817 203.24343716133328 L 72.83638854296484 210.57333607799995 L 87.49618637629817 217.90323499466663 Z"/></g></g><g><g><rect fill="white" stroke="none" x="93.65330146629817" y="236.96097217799993" width="385.0196536848438" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="96.29206507629817" y="252.79355383799995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">select amount from accounts where user_id=1 and type=C</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 72.83638854296484 259.83025679799994 L 485.0059878151419 259.83025679799994" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(499.4898680744752,259.83025679799994) translate(-499.4898680744752,-259.83025679799994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 484.83007024114187 252.50035788133326 L 499.4898680744752 259.83025679799994 L 484.83007024114187 267.1601557146666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="235.44994758446222" y="286.21789289799995" width="101.42636144851562" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="238.08871119446223" y="302.05047455799996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return 1 record</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 499.4898680744752 309.0871775179999 L 87.32026880229817 309.0871775179999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"/><g transform="translate(72.83638854296484,309.0871775179999) translate(-72.83638854296484,-309.0871775179999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.49618637629817 301.75727860133327 L 72.83638854296484 309.0871775179999 L 87.49618637629817 316.41707643466657 Z"/></g></g><g><g><rect fill="white" stroke="none" x="665.3496505656797" y="335.4748136179999" width="124.24668920730468" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="667.9884141756796" y="351.30739527799994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Start a transaction</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 955.4561222641887 358.3440982379999 L 513.9737483338085 358.3440982379999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(499.4898680744752,358.3440982379999) translate(-499.4898680744752,-358.3440982379999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 514.1496659078085 351.01419932133325 L 499.4898680744752 358.3440982379999 L 514.1496659078085 365.67399715466655 Z"/></g></g><g><g><rect fill="white" stroke="none" x="715.4677307048398" y="384.7317343379999" width="24.010528928984375" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="718.1064943148398" y="400.5643159979999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Ok</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 499.4898680744752 407.6010189579999 L 940.9722420048554 407.6010189579999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"/><g transform="translate(955.4561222641887,407.6010189579999) translate(-955.4561222641887,-407.6010189579999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 940.7963244308554 400.27112004133323 L 955.4561222641887 407.6010189579999 L 940.7963244308554 414.93091787466653 Z"/></g></g><g><g><rect fill="white" stroke="none" x="520.3067809978086" y="433.9886550579999" width="414.3324283430469" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="522.9455446078085" y="449.8212367179999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">insert into accounts (type, amount, user_id) values (C, 1000, 1)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 955.4561222641887 456.85793967799987 L 513.9737483338085 456.85793967799987" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(499.4898680744752,456.85793967799987) translate(-499.4898680744752,-456.85793967799987)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 514.1496659078085 449.5280407613332 L 499.4898680744752 456.85793967799987 L 514.1496659078085 464.1878385946665 Z"/></g></g><g><g><rect fill="white" stroke="none" x="715.4677307048398" y="483.2455757779999" width="24.010528928984375" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="718.1064943148398" y="499.0781574379999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Ok</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 499.4898680744752 506.11486039799985 L 940.9722420048554 506.11486039799985" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"/><g transform="translate(955.4561222641887,506.11486039799985) translate(-955.4561222641887,-506.11486039799985)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 940.7963244308554 498.7849614813332 L 955.4561222641887 506.11486039799985 L 940.7963244308554 513.4447593146665 Z"/></g></g><g><g><rect fill="white" stroke="none" x="633.1628219523984" y="532.5024964979998" width="188.62034643386718" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="635.8015855623984" y="548.3350781579998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Commit and end transaction</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 955.4561222641887 555.3717811179998 L 513.9737483338085 555.3717811179998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(499.4898680744752,555.3717811179998) translate(-499.4898680744752,-555.3717811179998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 514.1496659078085 548.0418822013331 L 499.4898680744752 555.3717811179998 L 514.1496659078085 562.7016800346665 Z"/></g></g><g><g><rect fill="white" stroke="none" x="717.0926467815" y="581.7594172179998" width="20.760696775664062" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="719.7314103914999" y="597.5919988779998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ok</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 499.4898680744752 604.6287018379999 L 940.9722420048554 604.6287018379999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"/><g transform="translate(955.4561222641887,604.6287018379999) translate(-955.4561222641887,-604.6287018379999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 940.7963244308554 597.2988029213332 L 955.4561222641887 604.6287018379999 L 940.7963244308554 611.9586007546666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="93.65330146629817" y="631.0163379379999" width="385.0196536848438" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="96.29206507629817" y="646.8489195979998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">select amount from accounts where user_id=1 and type=C</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 72.83638854296484 653.8856225579999 L 485.0059878151419 653.8856225579999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(499.4898680744752,653.8856225579999) translate(-499.4898680744752,-653.8856225579999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 484.83007024114187 646.5557236413332 L 499.4898680744752 653.8856225579999 L 484.83007024114187 661.2155214746666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="231.7849542983294" y="680.2732586579999" width="108.75634802078125" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="234.42371790832942" y="696.1058403179999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return 2 records</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 499.4898680744752 703.142543278 L 87.32026880229817 703.142543278" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"/><g transform="translate(72.83638854296484,703.142543278) translate(-72.83638854296484,-703.142543278)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.49618637629817 695.8126443613332 L 72.83638854296484 703.142543278 L 87.49618637629817 710.4724421946667 Z"/></g></g></g><g/><g/><g/></g></svg>